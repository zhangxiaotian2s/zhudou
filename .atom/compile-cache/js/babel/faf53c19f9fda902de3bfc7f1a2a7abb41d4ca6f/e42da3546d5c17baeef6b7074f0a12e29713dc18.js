'use babel';

/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _require = require('atom');

var Point = _require.Point;
var TextBuffer = _require.TextBuffer;

var ObjectiveCBracketBalancer = require('../lib/ObjectiveCBracketBalancer');
var getOpenBracketInsertPosition = ObjectiveCBracketBalancer.getOpenBracketInsertPosition;

describe('ObjectiveCBracketBalancer', function () {
  describe('getOpenBracketInsertPosition', function () {
    it('throws an error if the close bracket position does not contain a close bracket', function () {
      var error = new Error('The close bracket position must contain a close bracket');
      expect(function () {
        return getOpenBracketInsertPosition(new TextBuffer(''), Point.fromObject([0, 0]));
      }).toThrow(error);
      expect(function () {
        return getOpenBracketInsertPosition(new TextBuffer(' ]'), Point.fromObject([0, 0]));
      }).toThrow(error);
      expect(function () {
        return getOpenBracketInsertPosition(new TextBuffer('] '), Point.fromObject([0, 1]));
      }).toThrow(error);
    });

    it('returns the correct point on a line that contains no space before the close bracket', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer(']'), Point.fromObject([0, 0]))).toEqual(Point.fromObject([0, 0]));
    });

    it('returns the correct point on a line that contains only whitespace before the close bracket', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('   ]'), Point.fromObject([0, 3]))).toEqual(Point.fromObject([0, 3]));
    });

    it('inserts an open bracket at the start of an unbalanced simple expression', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('self setEnabled:NO]'), Point.fromObject([0, 18]))).toEqual(Point.fromObject([0, 0]));
    });

    it('does not insert an open bracket when completing a balanced simple expression', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[self setEnabled:NO]'), Point.fromObject([0, 19]))).toEqual(null);
    });

    it('inserts an open bracket at the beginning of an unbalanced nested expression', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[self foo] setEnabled:NO]'), Point.fromObject([0, 24]))).toEqual(Point.fromObject([0, 0]));
    });

    it('does not insert an open bracket when completing a balanced nested expression', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[[self foo] setEnabled:NO]'), Point.fromObject([0, 25]))).toEqual(null);
    });

    it('inserts an open bracket at the beginning of an unbalanced nested expression with an open bracket in a string literal', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[self fooWithBar:@"tricky ["] setEnabled:NO]'), Point.fromObject([0, 43]))).toEqual(Point.fromObject([0, 0]));
    });

    it('inserts an open bracket at the beginning of an unbalanced nested expression with an open bracket in a char literal', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[self fooWithBar:\'[\'] setEnabled:NO]'), Point.fromObject([0, 35]))).toEqual(Point.fromObject([0, 0]));
    });

    it('does not insert an open bracket at the beginning of a balanced nested expression with an open bracket in a char literal', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[foo(\'[\') setEnabled:NO]'), Point.fromObject([0, 23]))).toEqual(null);
    });

    it('inserts an open bracket before the nearest expression when within an existing balanced bracket pair', function () {
      // Start with:  [self setFoo:@"bar" |]
      //                          cursor  ^
      // Type ] and we should insert the [ before @"bar"
      // Ending with: [self setFoo:[@"bar" ]]
      expect(getOpenBracketInsertPosition(new TextBuffer('[self setFoo:@"bar" ]'), Point.fromObject([0, 20]))).toEqual(Point.fromObject([0, 13]));
    });

    it('inserts an open bracket at the beginning of an unbalanced expression across multiple lines', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('foo setFoo:@"foo"\nbar:@"bar"\nbaz:@"baz"]'), Point.fromObject([2, 10]))).toEqual(Point.fromObject([0, 0]));
    });

    it('does not insert an open bracket at the beginning of a balanced expression across multiple lines', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[foo setFoo:@"foo"\nbar:@"bar"\nbaz:@"baz"]'), Point.fromObject([2, 10]))).toEqual(null);
    });

    it('inserts an open bracket after an equals sign when initalizing or messaging a class', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('NSObject *foo = NSObject alloc]'), Point.fromObject([0, 30]))).toEqual(Point.fromObject([0, 16]));
    });

    it('does not insert an open bracket after an equals sign when initalizing or messaging a class with balanced brackets', function () {
      expect(getOpenBracketInsertPosition(new TextBuffer('[[NSObject alloc] init]'), Point.fromObject([0, 22]))).toEqual(null);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96aGFuZ3hpYW90aWFuLy5hdG9tL3BhY2thZ2VzL251Y2xpZGUtb2JqYy9zcGVjL09iamVjdGl2ZUNCcmFja2V0QmFsYW5jZXItc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7Ozs7Ozs7Ozs7ZUFVZ0IsT0FBTyxDQUFDLE1BQU0sQ0FBQzs7SUFBcEMsS0FBSyxZQUFMLEtBQUs7SUFBRSxVQUFVLFlBQVYsVUFBVTs7QUFDeEIsSUFBTSx5QkFBeUIsR0FBRyxPQUFPLENBQUMsa0NBQWtDLENBQUMsQ0FBQztJQUN2RSw0QkFBNEIsR0FBSSx5QkFBeUIsQ0FBekQsNEJBQTRCOztBQUVuQyxRQUFRLENBQUMsMkJBQTJCLEVBQUUsWUFBTTtBQUMxQyxVQUFRLENBQUMsOEJBQThCLEVBQUUsWUFBTTtBQUM3QyxNQUFFLENBQUMsZ0ZBQWdGLEVBQUUsWUFBTTtBQUN6RixVQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyx5REFBeUQsQ0FBQyxDQUFDO0FBQ25GLFlBQU0sQ0FBQztlQUFNLDRCQUE0QixDQUFDLElBQUksVUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztPQUFBLENBQUMsQ0FDbkYsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3BCLFlBQU0sQ0FBQztlQUFNLDRCQUE0QixDQUFDLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztPQUFBLENBQUMsQ0FDckYsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3BCLFlBQU0sQ0FBQztlQUFNLDRCQUE0QixDQUFDLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENB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QUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ3pILE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNwQixDQUFDLENBQUM7O0FBRUgsTUFBRSxDQUFDLG9GQUFvRixFQUFFLFlBQU07QUFDN0YsWUFBTSxDQUFDLDRCQUE0QixDQUFDLElBQUksVUFBVSxDQUFDLGlDQUFpQyxDQUFDLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDN0csT0FBTyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3pDLENBQUMsQ0FBQzs7QUFFSCxNQUFFLENBQUMsbUhBQW1ILEVBQUUsWUFBTTtBQUM1SCxZQUFNLENBQUMsNEJBQTRCLENBQUMsSUFBSSxVQUFVLENBQUMseUJBQXlCLENBQUMsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUNyRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDcEIsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6Ii9Vc2Vycy96aGFuZ3hpYW90aWFuLy5hdG9tL3BhY2thZ2VzL251Y2xpZGUtb2JqYy9zcGVjL09iamVjdGl2ZUNCcmFja2V0QmFsYW5jZXItc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5jb25zdCB7UG9pbnQsIFRleHRCdWZmZXJ9ID0gcmVxdWlyZSgnYXRvbScpO1xuY29uc3QgT2JqZWN0aXZlQ0JyYWNrZXRCYWxhbmNlciA9IHJlcXVpcmUoJy4uL2xpYi9PYmplY3RpdmVDQnJhY2tldEJhbGFuY2VyJyk7XG5jb25zdCB7Z2V0T3BlbkJyYWNrZXRJbnNlcnRQb3NpdGlvbn0gPSBPYmplY3RpdmVDQnJhY2tldEJhbGFuY2VyO1xuXG5kZXNjcmliZSgnT2JqZWN0aXZlQ0JyYWNrZXRCYWxhbmNlcicsICgpID0+IHtcbiAgZGVzY3JpYmUoJ2dldE9wZW5CcmFja2V0SW5zZXJ0UG9zaXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Rocm93cyBhbiBlcnJvciBpZiB0aGUgY2xvc2UgYnJhY2tldCBwb3NpdGlvbiBkb2VzIG5vdCBjb250YWluIGEgY2xvc2UgYnJhY2tldCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdUaGUgY2xvc2UgYnJhY2tldCBwb3NpdGlvbiBtdXN0IGNvbnRhaW4gYSBjbG9zZSBicmFja2V0Jyk7XG4gICAgICBleHBlY3QoKCkgPT4gZ2V0T3BlbkJyYWNrZXRJbnNlcnRQb3NpdGlvbihuZXcgVGV4dEJ1ZmZlcignJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDBdKSkpXG4gICAgICAgICAgLnRvVGhyb3coZXJyb3IpO1xuICAgICAgZXhwZWN0KCgpID0+IGdldE9wZW5CcmFja2V0SW5zZXJ0UG9zaXRpb24obmV3IFRleHRCdWZmZXIoJyBdJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDBdKSkpXG4gICAgICAgICAgLnRvVGhyb3coZXJyb3IpO1xuICAgICAgZXhwZWN0KCgpID0+IGdldE9wZW5CcmFja2V0SW5zZXJ0UG9zaXRpb24obmV3IFRleHRCdWZmZXIoJ10gJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDFdKSkpXG4gICAgICAgICAgLnRvVGhyb3coZXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3JldHVybnMgdGhlIGNvcnJlY3QgcG9pbnQgb24gYSBsaW5lIHRoYXQgY29udGFpbnMgbm8gc3BhY2UgYmVmb3JlIHRoZSBjbG9zZSBicmFja2V0JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGdldE9wZW5CcmFja2V0SW5zZXJ0UG9zaXRpb24obmV3IFRleHRCdWZmZXIoJ10nKSwgUG9pbnQuZnJvbU9iamVjdChbMCwgMF0pKSlcbiAgICAgICAgICAudG9FcXVhbChQb2ludC5mcm9tT2JqZWN0KFswLCAwXSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3JldHVybnMgdGhlIGNvcnJlY3QgcG9pbnQgb24gYSBsaW5lIHRoYXQgY29udGFpbnMgb25seSB3aGl0ZXNwYWNlIGJlZm9yZSB0aGUgY2xvc2UgYnJhY2tldCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKCcgICBdJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDNdKSkpXG4gICAgICAgICAgLnRvRXF1YWwoUG9pbnQuZnJvbU9iamVjdChbMCwgM10pKTtcbiAgICB9KTtcblxuICAgIGl0KCdpbnNlcnRzIGFuIG9wZW4gYnJhY2tldCBhdCB0aGUgc3RhcnQgb2YgYW4gdW5iYWxhbmNlZCBzaW1wbGUgZXhwcmVzc2lvbicsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKCdzZWxmIHNldEVuYWJsZWQ6Tk9dJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDE4XSkpKVxuICAgICAgICAgIC50b0VxdWFsKFBvaW50LmZyb21PYmplY3QoWzAsIDBdKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZG9lcyBub3QgaW5zZXJ0IGFuIG9wZW4gYnJhY2tldCB3aGVuIGNvbXBsZXRpbmcgYSBiYWxhbmNlZCBzaW1wbGUgZXhwcmVzc2lvbicsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKCdbc2VsZiBzZXRFbmFibGVkOk5PXScpLCBQb2ludC5mcm9tT2JqZWN0KFswLCAxOV0pKSlcbiAgICAgICAgICAudG9FcXVhbChudWxsKTtcbiAgICB9KTtcblxuICAgIGl0KCdpbnNlcnRzIGFuIG9wZW4gYnJhY2tldCBhdCB0aGUgYmVnaW5uaW5nIG9mIGFuIHVuYmFsYW5jZWQgbmVzdGVkIGV4cHJlc3Npb24nLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZ2V0T3BlbkJyYWNrZXRJbnNlcnRQb3NpdGlvbihuZXcgVGV4dEJ1ZmZlcignW3NlbGYgZm9vXSBzZXRFbmFibGVkOk5PXScpLCBQb2ludC5mcm9tT2JqZWN0KFswLCAyNF0pKSlcbiAgICAgICAgICAudG9FcXVhbChQb2ludC5mcm9tT2JqZWN0KFswLCAwXSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RvZXMgbm90IGluc2VydCBhbiBvcGVuIGJyYWNrZXQgd2hlbiBjb21wbGV0aW5nIGEgYmFsYW5jZWQgbmVzdGVkIGV4cHJlc3Npb24nLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZ2V0T3BlbkJyYWNrZXRJbnNlcnRQb3NpdGlvbihuZXcgVGV4dEJ1ZmZlcignW1tzZWxmIGZvb10gc2V0RW5hYmxlZDpOT10nKSwgUG9pbnQuZnJvbU9iamVjdChbMCwgMjVdKSkpXG4gICAgICAgICAgLnRvRXF1YWwobnVsbCk7XG4gICAgfSk7XG5cbiAgICBpdCgnaW5zZXJ0cyBhbiBvcGVuIGJyYWNrZXQgYXQgdGhlIGJlZ2lubmluZyBvZiBhbiB1bmJhbGFuY2VkIG5lc3RlZCBleHByZXNzaW9uIHdpdGggYW4gb3BlbiBicmFja2V0IGluIGEgc3RyaW5nIGxpdGVyYWwnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZ2V0T3BlbkJyYWNrZXRJbnNlcnRQb3NpdGlvbihuZXcgVGV4dEJ1ZmZlcignW3NlbGYgZm9vV2l0aEJhcjpAXCJ0cmlja3kgW1wiXSBzZXRFbmFibGVkOk5PXScpLCBQb2ludC5mcm9tT2JqZWN0KFswLCA0M10pKSlcbiAgICAgICAgICAudG9FcXVhbChQb2ludC5mcm9tT2JqZWN0KFswLCAwXSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2luc2VydHMgYW4gb3BlbiBicmFja2V0IGF0IHRoZSBiZWdpbm5pbmcgb2YgYW4gdW5iYWxhbmNlZCBuZXN0ZWQgZXhwcmVzc2lvbiB3aXRoIGFuIG9wZW4gYnJhY2tldCBpbiBhIGNoYXIgbGl0ZXJhbCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKGBbc2VsZiBmb29XaXRoQmFyOidbJ10gc2V0RW5hYmxlZDpOT11gKSwgUG9pbnQuZnJvbU9iamVjdChbMCwgMzVdKSkpXG4gICAgICAgICAgLnRvRXF1YWwoUG9pbnQuZnJvbU9iamVjdChbMCwgMF0pKTtcbiAgICB9KTtcblxuICAgIGl0KCdkb2VzIG5vdCBpbnNlcnQgYW4gb3BlbiBicmFja2V0IGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBiYWxhbmNlZCBuZXN0ZWQgZXhwcmVzc2lvbiB3aXRoIGFuIG9wZW4gYnJhY2tldCBpbiBhIGNoYXIgbGl0ZXJhbCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKGBbZm9vKCdbJykgc2V0RW5hYmxlZDpOT11gKSwgUG9pbnQuZnJvbU9iamVjdChbMCwgMjNdKSkpXG4gICAgICAgICAgLnRvRXF1YWwobnVsbCk7XG4gICAgfSk7XG5cbiAgICBpdCgnaW5zZXJ0cyBhbiBvcGVuIGJyYWNrZXQgYmVmb3JlIHRoZSBuZWFyZXN0IGV4cHJlc3Npb24gd2hlbiB3aXRoaW4gYW4gZXhpc3RpbmcgYmFsYW5jZWQgYnJhY2tldCBwYWlyJywgKCkgPT4ge1xuICAgICAgLy8gU3RhcnQgd2l0aDogIFtzZWxmIHNldEZvbzpAXCJiYXJcIiB8XVxuICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvciAgXlxuICAgICAgLy8gVHlwZSBdIGFuZCB3ZSBzaG91bGQgaW5zZXJ0IHRoZSBbIGJlZm9yZSBAXCJiYXJcIlxuICAgICAgLy8gRW5kaW5nIHdpdGg6IFtzZWxmIHNldEZvbzpbQFwiYmFyXCIgXV1cbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKCdbc2VsZiBzZXRGb286QFwiYmFyXCIgXScpLCBQb2ludC5mcm9tT2JqZWN0KFswLCAyMF0pKSlcbiAgICAgICAgICAudG9FcXVhbChQb2ludC5mcm9tT2JqZWN0KFswLCAxM10pKTtcbiAgICB9KTtcblxuICAgIGl0KCdpbnNlcnRzIGFuIG9wZW4gYnJhY2tldCBhdCB0aGUgYmVnaW5uaW5nIG9mIGFuIHVuYmFsYW5jZWQgZXhwcmVzc2lvbiBhY3Jvc3MgbXVsdGlwbGUgbGluZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZ2V0T3BlbkJyYWNrZXRJbnNlcnRQb3NpdGlvbihuZXcgVGV4dEJ1ZmZlcignZm9vIHNldEZvbzpAXCJmb29cIlxcbmJhcjpAXCJiYXJcIlxcbmJhejpAXCJiYXpcIl0nKSwgUG9pbnQuZnJvbU9iamVjdChbMiwgMTBdKSkpXG4gICAgICAgICAgLnRvRXF1YWwoUG9pbnQuZnJvbU9iamVjdChbMCwgMF0pKTtcbiAgICB9KTtcblxuICAgIGl0KCdkb2VzIG5vdCBpbnNlcnQgYW4gb3BlbiBicmFja2V0IGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBiYWxhbmNlZCBleHByZXNzaW9uIGFjcm9zcyBtdWx0aXBsZSBsaW5lcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKCdbZm9vIHNldEZvbzpAXCJmb29cIlxcbmJhcjpAXCJiYXJcIlxcbmJhejpAXCJiYXpcIl0nKSwgUG9pbnQuZnJvbU9iamVjdChbMiwgMTBdKSkpXG4gICAgICAgICAgLnRvRXF1YWwobnVsbCk7XG4gICAgfSk7XG5cbiAgICBpdCgnaW5zZXJ0cyBhbiBvcGVuIGJyYWNrZXQgYWZ0ZXIgYW4gZXF1YWxzIHNpZ24gd2hlbiBpbml0YWxpemluZyBvciBtZXNzYWdpbmcgYSBjbGFzcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChnZXRPcGVuQnJhY2tldEluc2VydFBvc2l0aW9uKG5ldyBUZXh0QnVmZmVyKCdOU09iamVjdCAqZm9vID0gTlNPYmplY3QgYWxsb2NdJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDMwXSkpKVxuICAgICAgICAgIC50b0VxdWFsKFBvaW50LmZyb21PYmplY3QoWzAsIDE2XSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RvZXMgbm90IGluc2VydCBhbiBvcGVuIGJyYWNrZXQgYWZ0ZXIgYW4gZXF1YWxzIHNpZ24gd2hlbiBpbml0YWxpemluZyBvciBtZXNzYWdpbmcgYSBjbGFzcyB3aXRoIGJhbGFuY2VkIGJyYWNrZXRzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGdldE9wZW5CcmFja2V0SW5zZXJ0UG9zaXRpb24obmV3IFRleHRCdWZmZXIoJ1tbTlNPYmplY3QgYWxsb2NdIGluaXRdJyksIFBvaW50LmZyb21PYmplY3QoWzAsIDIyXSkpKVxuICAgICAgICAgIC50b0VxdWFsKG51bGwpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19
//# sourceURL=/Users/zhangxiaotian/.atom/packages/nuclide-objc/spec/ObjectiveCBracketBalancer-spec.js
