function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _libRecentFilesService = require('../lib/RecentFilesService');

var _libRecentFilesService2 = _interopRequireDefault(_libRecentFilesService);

var _assert = require('assert');

var _assert2 = _interopRequireDefault(_assert);

'use babel';

var ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS = 101;
var FILE_PATH_1 = 'foo/bar/foo.js';
var FILE_PATH_2 = 'foo/bar/bar.js';
var FILE_PATH_3 = 'foo/bar/baz.js';

describe('RecentFilesService', function () {
  var recentFilesService = undefined;
  var origDateNow = undefined;

  beforeEach(function () {
    origDateNow = Date.now;
    /*
     * `RecentFileService` listens for `onWorkspaceDidStopChangingActivePaneItem`, which debounces
     * calls to `onDidChangeActivePaneItem`. `debounce` calls `Date.now` to determine whether to
     * call callbacks.
     *
     * Mock `Date.now` to use the fake Jasmine clock so `advanceClock` can be called synchronously
     * and call appropriate callbacks deterministically.
     */
    // $FlowFixMe
    Date.now = function () {
      return window.now;
    };
    recentFilesService = new _libRecentFilesService2['default']();
  });

  afterEach(function () {
    // $FlowFixMe
    Date.now = origDateNow;
  });

  describe('getRecentFiles', function () {
    it('returns a reverse-chronological list of recently opened files', function () {
      waitsForPromise(_asyncToGenerator(function* () {
        var mostRecentFiles = undefined;
        var previousTimestamp = 0;
        expect(recentFilesService.getRecentFiles().length).toEqual(0);

        yield atom.workspace.open(FILE_PATH_1);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(1);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_1)).toBe(true);
        expect(mostRecentFiles[0].timestamp).toBeGreaterThan(previousTimestamp);
        previousTimestamp = mostRecentFiles[0].timestamp;

        yield atom.workspace.open(FILE_PATH_2);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(2);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_2)).toBe(true);
        expect(mostRecentFiles[0].timestamp).toBeGreaterThan(previousTimestamp);

        previousTimestamp = mostRecentFiles[0].timestamp;
        yield atom.workspace.open(FILE_PATH_3);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(3);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_3)).toBe(true);
        expect(mostRecentFiles[0].timestamp).toBeGreaterThan(previousTimestamp);
      }));
    });

    it('returns paths and timestamps of recently opened files', function () {
      waitsForPromise(_asyncToGenerator(function* () {
        yield atom.workspace.open(FILE_PATH_1);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        var recentFiles = recentFilesService.getRecentFiles();
        var mostRecentFile = recentFiles[0];
        expect(Object.keys(mostRecentFile).length).toEqual(2);
        expect(typeof mostRecentFile.timestamp === 'number').toBe(true);
        expect(mostRecentFile.path.endsWith(FILE_PATH_1)).toBe(true);
      }));
    });

    it('resets the order of previously tracked files when they are touched', function () {
      waitsForPromise(_asyncToGenerator(function* () {
        var mostRecentFiles = undefined;
        expect(recentFilesService.getRecentFiles().length).toEqual(0);

        yield atom.workspace.open(FILE_PATH_1);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(1);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_1)).toBe(true);

        yield atom.workspace.open(FILE_PATH_2);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(2);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_2)).toBe(true);

        yield atom.workspace.open(FILE_PATH_1);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(2);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_1)).toBe(true);
        expect(mostRecentFiles[1].path.endsWith(FILE_PATH_2)).toBe(true);

        yield atom.workspace.open(FILE_PATH_2);
        advanceClock(ON_DID_CHANGE_ACTIVE_PANE_ITEM_DEBOUNCE_MS);
        mostRecentFiles = recentFilesService.getRecentFiles();
        expect(mostRecentFiles.length).toEqual(2);
        expect(mostRecentFiles[0].path.endsWith(FILE_PATH_2)).toBe(true);
        expect(mostRecentFiles[1].path.endsWith(FILE_PATH_1)).toBe(true);
      }));
    });
  });

  describe('initialization and de-serialization', function () {
    it('correctly restores itself from serialized state', function () {
      var serializedState = { filelist: [{ path: FILE_PATH_1, timestamp: 100 }, { path: FILE_PATH_2, timestamp: 200 }, { path: FILE_PATH_3, timestamp: 300 }] };
      var restoredRecentFilesService = new _libRecentFilesService2['default'](serializedState);
      var mostRecentFiles = restoredRecentFilesService.getRecentFiles();
      expect(mostRecentFiles).toEqual(serializedState.filelist);
    });

    it('starts out empty if no serialized state is passed to the constructor', function () {
      (0, _assert2['default'])(recentFilesService);
      expect(recentFilesService.getRecentFiles().length).toEqual(0);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy96aGFuZ3hpYW90aWFuLy5hdG9tL3BhY2thZ2VzL251Y2xpZGUtcmVjZW50LWZpbGVzLXNlcnZpY2Uvc3BlYy9SZWNlbnRGaWxlc1NlcnZpY2Utc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7cUNBVytCLDJCQUEyQjs7OztzQkFFcEMsUUFBUTs7OztBQWI5QixXQUFXLENBQUM7O0FBZVosSUFBTSwwQ0FBMEMsR0FBRyxHQUFHLENBQUM7QUFDdkQsSUFBTSxXQUFXLEdBQUcsZ0JBQWdCLENBQUM7QUFDckMsSUFBTSxXQUFXLEdBQUcsZ0JBQWdCLENBQUM7QUFDckMsSUFBTSxXQUFXLEdBQUcsZ0JBQWdCLENBQUM7O0FBRXJDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxZQUFNO0FBQ25DLE1BQUksa0JBQXVCLFlBQUEsQ0FBQztBQUM1QixNQUFJLFdBQWdCLFlBQUEsQ0FBQzs7QUFFckIsWUFBVSxDQUFDLFlBQU07QUFDZixlQUFXLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQzs7Ozs7Ozs7OztBQVV2QixRQUFJLENBQUMsR0FBRyxHQUFHO2FBQU0sTUFBTSxDQUFDLEdBQUc7S0FBQSxDQUFDO0FBQzVCLHNCQUFrQixHQUFHLHdDQUF3QixDQUFDO0dBQy9DLENBQUMsQ0FBQzs7QUFFSCxXQUFTLENBQUMsWUFBTTs7QUFFZCxRQUFJLENBQUMsR0FBRyxHQUFHLFdBQVcsQ0FBQztHQUN4QixDQUFDLENBQUM7O0FBRUgsVUFBUSxDQUFDLGdCQUFnQixFQUFFLFlBQU07QUFDL0IsTUFBRSxDQUFDLCtEQUErRCxFQUFFLFlBQU07QUFDeEUscUJBQWUsbUJBQUMsYUFBWTtBQUMxQixZQUFJLGVBQWUsWUFBQSxDQUFDO0FBQ3BCLFlBQUksaUJBQWlCLEdBQUcsQ0FBQyxDQUFDO0FBQzFCLGNBQU0sQ0FBQyxrQkFBa0IsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7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RUFBQyxJQUFJLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUMsRUFDbkMsRUFBQyxJQUFJLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUMsRUFDbkMsRUFBQyxJQUFJLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUMsQ0FDcEMsRUFBQyxDQUFDO0FBQ0gsVUFBTSwwQkFBMEIsR0FBRyx1Q0FBdUIsZUFBZSxDQUFDLENBQUM7QUFDM0UsVUFBTSxlQUFlLEdBQUcsMEJBQTBCLENBQUMsY0FBYyxFQUFFLENBQUM7QUFDcEUsWUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7S0FDM0QsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyxzRUFBc0UsRUFBRSxZQUFNO0FBQy9FLCtCQUFVLGtCQUFrQixDQUFDLENBQUM7QUFDOUIsWUFBTSxDQUFDLGtCQUFrQixDQUFDLGNBQWMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUMvRCxDQUFDLENBQUM7R0FFSixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoiL1VzZXJzL3poYW5neGlhb3RpYW4vLmF0b20vcGFja2FnZXMvbnVjbGlkZS1yZWNlbnQtZmlsZXMtc2VydmljZS9zcGVjL1JlY2VudEZpbGVzU2VydmljZS1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuaW1wb3J0IFJlY2VudEZpbGVzU2VydmljZSBmcm9tICcuLi9saWIvUmVjZW50RmlsZXNTZXJ2aWNlJztcblxuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuXG5jb25zdCBPTl9ESURfQ0hBTkdFX0FDVElWRV9QQU5FX0lURU1fREVCT1VOQ0VfTVMgPSAxMDE7XG5jb25zdCBGSUxFX1BBVEhfMSA9ICdmb28vYmFyL2Zvby5qcyc7XG5jb25zdCBGSUxFX1BBVEhfMiA9ICdmb28vYmFyL2Jhci5qcyc7XG5jb25zdCBGSUxFX1BBVEhfMyA9ICdmb28vYmFyL2Jhei5qcyc7XG5cbmRlc2NyaWJlKCdSZWNlbnRGaWxlc1NlcnZpY2UnLCAoKSA9PiB7XG4gIGxldCByZWNlbnRGaWxlc1NlcnZpY2U6IGFueTtcbiAgbGV0IG9yaWdEYXRlTm93OiBhbnk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgb3JpZ0RhdGVOb3cgPSBEYXRlLm5vdztcbiAgICAvKlxuICAgICAqIGBSZWNlbnRGaWxlU2VydmljZWAgbGlzdGVucyBmb3IgYG9uV29ya3NwYWNlRGlkU3RvcENoYW5naW5nQWN0aXZlUGFuZUl0ZW1gLCB3aGljaCBkZWJvdW5jZXNcbiAgICAgKiBjYWxscyB0byBgb25EaWRDaGFuZ2VBY3RpdmVQYW5lSXRlbWAuIGBkZWJvdW5jZWAgY2FsbHMgYERhdGUubm93YCB0byBkZXRlcm1pbmUgd2hldGhlciB0b1xuICAgICAqIGNhbGwgY2FsbGJhY2tzLlxuICAgICAqXG4gICAgICogTW9jayBgRGF0ZS5ub3dgIHRvIHVzZSB0aGUgZmFrZSBKYXNtaW5lIGNsb2NrIHNvIGBhZHZhbmNlQ2xvY2tgIGNhbiBiZSBjYWxsZWQgc3luY2hyb25vdXNseVxuICAgICAqIGFuZCBjYWxsIGFwcHJvcHJpYXRlIGNhbGxiYWNrcyBkZXRlcm1pbmlzdGljYWxseS5cbiAgICAgKi9cbiAgICAvLyAkRmxvd0ZpeE1lXG4gICAgRGF0ZS5ub3cgPSAoKSA9PiB3aW5kb3cubm93O1xuICAgIHJlY2VudEZpbGVzU2VydmljZSA9IG5ldyBSZWNlbnRGaWxlc1NlcnZpY2UoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAvLyAkRmxvd0ZpeE1lXG4gICAgRGF0ZS5ub3cgPSBvcmlnRGF0ZU5vdztcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFJlY2VudEZpbGVzJywgKCkgPT4ge1xuICAgIGl0KCdyZXR1cm5zIGEgcmV2ZXJzZS1jaHJvbm9sb2dpY2FsIGxpc3Qgb2YgcmVjZW50bHkgb3BlbmVkIGZpbGVzJywgKCkgPT4ge1xuICAgICAgd2FpdHNGb3JQcm9taXNlKGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IG1vc3RSZWNlbnRGaWxlcztcbiAgICAgICAgbGV0IHByZXZpb3VzVGltZXN0YW1wID0gMDtcbiAgICAgICAgZXhwZWN0KHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpLmxlbmd0aCkudG9FcXVhbCgwKTtcblxuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8xKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgxKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8xKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbihwcmV2aW91c1RpbWVzdGFtcCk7XG4gICAgICAgIHByZXZpb3VzVGltZXN0YW1wID0gbW9zdFJlY2VudEZpbGVzWzBdLnRpbWVzdGFtcDtcblxuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8yKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgyKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8yKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbihwcmV2aW91c1RpbWVzdGFtcCk7XG5cbiAgICAgICAgcHJldmlvdXNUaW1lc3RhbXAgPSBtb3N0UmVjZW50RmlsZXNbMF0udGltZXN0YW1wO1xuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8zKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgzKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8zKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbihwcmV2aW91c1RpbWVzdGFtcCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdyZXR1cm5zIHBhdGhzIGFuZCB0aW1lc3RhbXBzIG9mIHJlY2VudGx5IG9wZW5lZCBmaWxlcycsICgpID0+IHtcbiAgICAgIHdhaXRzRm9yUHJvbWlzZShhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oRklMRV9QQVRIXzEpO1xuICAgICAgICBhZHZhbmNlQ2xvY2soT05fRElEX0NIQU5HRV9BQ1RJVkVfUEFORV9JVEVNX0RFQk9VTkNFX01TKTtcbiAgICAgICAgY29uc3QgcmVjZW50RmlsZXMgPSByZWNlbnRGaWxlc1NlcnZpY2UuZ2V0UmVjZW50RmlsZXMoKTtcbiAgICAgICAgY29uc3QgbW9zdFJlY2VudEZpbGUgPSByZWNlbnRGaWxlc1swXTtcbiAgICAgICAgZXhwZWN0KE9iamVjdC5rZXlzKG1vc3RSZWNlbnRGaWxlKS5sZW5ndGgpLnRvRXF1YWwoMik7XG4gICAgICAgIGV4cGVjdCh0eXBlb2YgbW9zdFJlY2VudEZpbGUudGltZXN0YW1wID09PSAnbnVtYmVyJykudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlLnBhdGguZW5kc1dpdGgoRklMRV9QQVRIXzEpKS50b0JlKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgncmVzZXRzIHRoZSBvcmRlciBvZiBwcmV2aW91c2x5IHRyYWNrZWQgZmlsZXMgd2hlbiB0aGV5IGFyZSB0b3VjaGVkJywgKCkgPT4ge1xuICAgICAgd2FpdHNGb3JQcm9taXNlKGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IG1vc3RSZWNlbnRGaWxlcztcbiAgICAgICAgZXhwZWN0KHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpLmxlbmd0aCkudG9FcXVhbCgwKTtcblxuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8xKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgxKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8xKSkudG9CZSh0cnVlKTtcblxuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8yKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgyKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8yKSkudG9CZSh0cnVlKTtcblxuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8xKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgyKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8xKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1sxXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8yKSkudG9CZSh0cnVlKTtcblxuICAgICAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKEZJTEVfUEFUSF8yKTtcbiAgICAgICAgYWR2YW5jZUNsb2NrKE9OX0RJRF9DSEFOR0VfQUNUSVZFX1BBTkVfSVRFTV9ERUJPVU5DRV9NUyk7XG4gICAgICAgIG1vc3RSZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpO1xuICAgICAgICBleHBlY3QobW9zdFJlY2VudEZpbGVzLmxlbmd0aCkudG9FcXVhbCgyKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1swXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8yKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vc3RSZWNlbnRGaWxlc1sxXS5wYXRoLmVuZHNXaXRoKEZJTEVfUEFUSF8xKSkudG9CZSh0cnVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW5pdGlhbGl6YXRpb24gYW5kIGRlLXNlcmlhbGl6YXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ2NvcnJlY3RseSByZXN0b3JlcyBpdHNlbGYgZnJvbSBzZXJpYWxpemVkIHN0YXRlJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VyaWFsaXplZFN0YXRlID0ge2ZpbGVsaXN0OiBbXG4gICAgICAgIHtwYXRoOiBGSUxFX1BBVEhfMSwgdGltZXN0YW1wOiAxMDB9LFxuICAgICAgICB7cGF0aDogRklMRV9QQVRIXzIsIHRpbWVzdGFtcDogMjAwfSxcbiAgICAgICAge3BhdGg6IEZJTEVfUEFUSF8zLCB0aW1lc3RhbXA6IDMwMH0sXG4gICAgICBdfTtcbiAgICAgIGNvbnN0IHJlc3RvcmVkUmVjZW50RmlsZXNTZXJ2aWNlID0gbmV3IFJlY2VudEZpbGVzU2VydmljZShzZXJpYWxpemVkU3RhdGUpO1xuICAgICAgY29uc3QgbW9zdFJlY2VudEZpbGVzID0gcmVzdG9yZWRSZWNlbnRGaWxlc1NlcnZpY2UuZ2V0UmVjZW50RmlsZXMoKTtcbiAgICAgIGV4cGVjdChtb3N0UmVjZW50RmlsZXMpLnRvRXF1YWwoc2VyaWFsaXplZFN0YXRlLmZpbGVsaXN0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzdGFydHMgb3V0IGVtcHR5IGlmIG5vIHNlcmlhbGl6ZWQgc3RhdGUgaXMgcGFzc2VkIHRvIHRoZSBjb25zdHJ1Y3RvcicsICgpID0+IHtcbiAgICAgIGludmFyaWFudChyZWNlbnRGaWxlc1NlcnZpY2UpO1xuICAgICAgZXhwZWN0KHJlY2VudEZpbGVzU2VydmljZS5nZXRSZWNlbnRGaWxlcygpLmxlbmd0aCkudG9FcXVhbCgwKTtcbiAgICB9KTtcblxuICB9KTtcbn0pO1xuIl19
//# sourceURL=/Users/zhangxiaotian/.atom/packages/nuclide-recent-files-service/spec/RecentFilesService-spec.js
